name: obs-upload
description: Upload files to OBS (Open Build Service)
branding:
  color: green
  icon: upload-cloud
inputs:
  apiurl:
    description: OBS apiurl
    required: false
    default: https://api.opensuse.org
  username:
    description: OBS username
    required: true
  password:
    description: OBS password
    required: true
  project:
    description: OBS project
    required: true
  package:
    description: OBS package
    required: true
  pre-run:
    description: Run some commands before everything
    required: false
    default: ''
  type:
    description: The type of the package
    required: false
    default: ''
  files:
    description: Files
    required: false
    default: ''
runs:
  using: composite
  steps:
    - name: Pre-run
      if: ${{ inputs.pre-run != '' }}
      run: ${{ inputs.pre-run }}
      shell: bash
    - name: Set Github Path
      run: echo ${{ github.action_path }} >> $GITHUB_PATH
      shell: bash
    - name: Upload
      run: upload.sh
      shell: bash
      env:
        OBS_APIURL: ${{ inputs.apiurl }}
        OBS_USERNAME: ${{ inputs.username }}
        OBS_PASSWORD: ${{ inputs.password }}
        OBS_PROJECT: ${{ inputs.project }}
        OBS_PACKAGE: ${{ inputs.package }}
        OBS_TYPE: ${{ inputs.type }}
        OBS_FILES: ${{ inputs.files }}
